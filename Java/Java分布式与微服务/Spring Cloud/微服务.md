[TOC]

## 微服务基本概念

### 什么是微服务？

一种架构风格  

开发单个应用作为一系列小型服务的套件，其中每个服务都运行在自己的进程中，并且通过轻量级的机制实现彼此间的通信，这通常是http资源API

#### **单体应用的痛点：**

项目庞大，可能有几十张表。

容易出现尾大不掉的情景
代码风格，组件不统一

#### **技术难以升级什么是服务化？**

1. 拆分：大而全变成了小而 美

2. 独立: 独立开发，独立部署，职责明确

3. 通信：不关心具体实现

   

维基百科：1.专注于单一责任与功能的小型功能区块为基础。2.各功能区块使用与语言无关的API集相互通信。



### **微服务的特点**

技术栈自由

按需弹性扩容

能力复用率高

部署和回滚成本低

康威定律：组织结构会跟着变动

### **微服务的优缺点**

#### **微服务优点：**

技术栈不受限，新技术有发展空间

可用性强，一个宕机不会整体都宕机

代码和机器的使用率都提高了

#### **微服务缺点：**

运维成本过高

接口可能不匹配

代码可能重复

架构复杂度提高

### 微服务两大门派

Spring Cloud :由众多子项目组成

Dubbo官网的定义：高性能，轻量级的开源服务框架   

Dubbo 提供的能力只是Spring Cloud 的子集\

Dubbo使用RPC，效率更高

Spring Cloud 使用REST，更灵活。

调用RPC，引入对方的包。

REST只需 要接口文档。

生态和社区活跃度

迭代速度

考拉造型经验：dubbo完备的功能和文档。相比于

对于中小型企业，Spring Cloud  更好

## 微服务的拆分、扩展与重要模块

### 服务的拆分

#### **什么时候进行服务化拆分：**

1，第一阶段的主要目标是快速开发和验证想法（通常第一阶段都打包在一起进行开发运维，这是最高效也最节省成本的方式）

2，进一步增加更多的新特性来吸引更多的目标用户

3，同时进行开发的人员超过10人，这个时候就该考虑进行服务化拆分了

#### **不适合拆分的情况：**

1，小团队，技术基础较为薄弱

2，流量不高，压力小，业务变化也不大（比如企业内部的管理系统）

3，对延迟很敏感的低延迟高并发系统

#### **微服务拆分的两种方式：**

1，纵向拆分：按照业务维度去拆分，关联程度紧的就拆分成一个微服务，功能比较独立的拆分成一个微服务。比如社交app，可以对评论，消息，个人主页独立拆分

2，横向拆分：按照公共领域去拆分，比如社交app，评论，消息，个人主页都需要用到用户模块，如果纵向拆分里这几个模块都分别实现用户模块，成本就太高了，可以把用户服务作为横向拆分出来，并且把这个功能提供给各个模块，这样用户服务复用性就很高

3，结合业务综合分析，一般需要同时采用横向和纵向两种，无论是采用横向还是纵向拆分，不一定是拆分的越细越好，过细会让服务数量膨胀，变得难以管理，要结合实际进行拆分，建议每个开发负责的服务不超过3个。

### 服务扩展

**服务扩展：**

* 单体集群：水平复制
* 微服务：功能解耦
* 数据拆分：分库分表

**按需扩展：**

* CPU、内存、网络负载程度
* 特定时间（比如双11）、
* 具有最佳使用率，节约成本

### 微服务重要模块

1. 服务注册中心：不注册消费者就不知道去哪里找到
2. 服务框架：注册好后还需要解决以下问题，比如采用什么协议，传输类型等，服务框架就会对此进行统一
3. 负载均衡:   不需要将所有的压力放在一台服务器上
4. 网关：当服务多了以后，需要统一网关，然后由网关进行下一步的分发，还有进行统一转换，权限校验，过滤等
5. 熔断与降级：原来的旧架构无法支持服务，如果某个地方出现问题可以通过熔断与降级将某个出问题的功能停用

